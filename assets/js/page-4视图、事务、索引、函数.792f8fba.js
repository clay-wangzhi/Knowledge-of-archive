(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{690:function(s,n,a){"use strict";a.r(n);var e=a(1),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_4-视图、事务、索引、函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-视图、事务、索引、函数"}},[s._v("#")]),s._v(" 4 视图、事务、索引、函数")]),s._v(" "),a("h2",{attrs:{id:"_1-视图【view】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-视图【view】"}},[s._v("#")]),s._v(" 1 视图【view】")]),s._v(" "),a("p",[s._v("1、\t视图是一张虚拟表，它表示一张表的部分或多张表的综合的结构。")]),s._v(" "),a("p",[s._v("2、\t视图仅仅是表结构，没有表数据。视图的结构和数据建立在表的基础上。")]),s._v(" "),a("h3",{attrs:{id:"_1-1-创建视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-创建视图"}},[s._v("#")]),s._v(" 1.1 创建视图")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create [or replace] view 视图的名称\nas\n\tselect语句;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create view vw_stu\n    -> as\n    -> select stuname,stusex,writtenexam,labexam from stuinfo inner join stumarks using(stuno);\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("多学一招：因为视图是一个表结构，所以创建视图后，会在数据库文件夹中多一个与视图名同名的.frm文件\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_1-2-使用视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-使用视图"}},[s._v("#")]),s._v(" 1.2 使用视图")]),s._v(" "),a("p",[s._v("视图是一张虚拟表，视图的用法和表的用法一样的")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> select * from vw_stu;\n+----------+--------+-------------+---------+\n| stuname  | stusex | writtenexam | labexam |\n+----------+--------+-------------+---------+\n| 李斯文        | 女      |          80 |      58 |\n| 李文才        | 男       |          50 |      90 |\n| 欧阳俊雄        | 男       |          65 |      50 |\n| 张秋丽         | 男       |          77 |      82 |\n| 争青小子        | 男       |          56 |      48 |\n+----------+--------+-------------+---------+\n\nmysql> update vw_stu set writtenexam=88 where stuname='李斯文';\nQuery OK, 1 row affected (0.05 sec)\nRows matched: 1  Changed: 1  Warnings: 0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"_1-3-查看视图的结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-查看视图的结构"}},[s._v("#")]),s._v(" 1.3 查看视图的结构")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("desc 视图名;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> desc vw_stu;\n+-------------+-------------+------+-----+---------+-------+\n| Field       | Type        | Null | Key | Default | Extra |\n+-------------+-------------+------+-----+---------+-------+\n| stuname     | varchar(10) | NO   |     | NULL    |       |\n| stusex      | char(2)     | NO   |     | NULL    |       |\n| writtenexam | int(11)     | YES  |     | NULL    |       |\n| labexam     | int(11)     | YES  |     | NULL    |       |\n+-------------+-------------+------+-----+---------+-------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"_1-4-查看创建视图的语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-查看创建视图的语法"}},[s._v("#")]),s._v(" 1.4 查看创建视图的语法")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("show create view 视图名\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/1537067071676.png",alt:"1537067071676"}})]),s._v(" "),a("h3",{attrs:{id:"_1-5-显示所有视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-显示所有视图"}},[s._v("#")]),s._v(" 1.5 显示所有视图")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" #方法一：\nmysql> show tables;\n+------------------+\n| Tables_in_itcast |\n+------------------+\n| stu              |\n| stuinfo          |\n| stumarks         |\n| t1               |\n| t2               |\n| vw_stu           |\n\n# 方法二\nmysql> select table_name from information_schema.views;\n+------------+\n| table_name |\n+------------+\n| vw_stu     |\n+------------+\n1 row in set (0.05 sec)\n+------------------+\n\n#方法三\nmysql> show table status where comment='view' \\G\n*************************** 1. row ***************************\n           Name: vw_stu\n         Engine: NULL\n        Version: NULL\n     Row_format: NULL\n           Rows: NULL\n Avg_row_length: NULL\n    Data_length: NULL\nMax_data_length: NULL\n   Index_length: NULL\n      Data_free: NULL\n Auto_increment: NULL\n    Create_time: NULL\n    Update_time: NULL\n     Check_time: NULL\n      Collation: NULL\n       Checksum: NULL\n Create_options: NULL\n        Comment: VIEW\n1 row in set (0.00 sec)\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br")])]),a("h3",{attrs:{id:"_1-6-更改视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-更改视图"}},[s._v("#")]),s._v(" 1.6 更改视图")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("alter view 视图名\nas\n\tselect 语句\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> alter view vw_stu\n    -> as\n    -> select * from stuinfo;\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_1-7-删除视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-删除视图"}},[s._v("#")]),s._v(" 1.7 删除视图")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("drop view [if exists] 视图1,视图2,…\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> drop view vw_stu;\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_1-8-视图的作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-8-视图的作用"}},[s._v("#")]),s._v(" 1.8 视图的作用")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("筛选数据，防止未经许可访问敏感数据")])]),s._v(" "),a("li",[a("p",[s._v("隐藏表结构")])]),s._v(" "),a("li",[a("p",[s._v("降低SQL语句的复杂度")])])]),s._v(" "),a("h3",{attrs:{id:"_1-9视图的算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-9视图的算法"}},[s._v("#")]),s._v(" 1.9\t视图的算法")]),s._v(" "),a("p",[s._v("场景：找出语文成绩最高的男生和女生")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> select * from (select * from stu order by ch desc) as t group by stusex;\n+--------+----------+--------+--------+---------+------------+------+------+\n| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |\n+--------+----------+--------+--------+---------+------------+------+------+\n| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |\n| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |\n+--------+----------+--------+--------+---------+------------+------+------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("我们可以将子查询封装到视图中")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create view vw_stu\n    -> as\n    -> select * from stu order by ch desc;\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("可以将上面的子查询更改成视图，但是，结果和上面不一样")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> select * from vw_stu group by stusex;\n+--------+---------+--------+--------+---------+------------+------+------+\n| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress | ch   | math |\n+--------+---------+--------+--------+---------+------------+------+------+\n| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |   80 | NULL |\n| s25303 | 李斯文       | 女      |     22 |       2 | 北京           |   55 |   82 |\n+--------+---------+--------+--------+---------+------------+------+------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("原因：这是因为视图的算法造成的")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1. merge：合并算法，将视图的语句和外层的语句合并后在执行。\n2. temptable：临时表算法，将视图生成一个临时表，再执行外层语句\n3. undefined：未定义，MySQL到底用merge还是用temptable由MySQL决定，这是一个默认的算法，一般视图都会选择merge算法，因为merge效率高。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("解决：在创建视图的时候指定视图的算法")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create algorithm=temptable view 视图名\nas\n\tselect 语句\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("指定算法创建视图")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create algorithm=temptable view vw_stu\n    -> as\n    ->  select * from stu order by ch desc;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> select * from vw_stu group by stusex;   # 结果是一致的\n+--------+----------+--------+--------+---------+------------+------+------+\n| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress | ch   | math |\n+--------+----------+--------+--------+---------+------------+------+------+\n| s25321 | Tabm     | 女      |     23 |       9 | 河北          |   88 |   77 |\n| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |   86 |   92 |\n+--------+----------+--------+--------+---------+------------+------+------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h2",{attrs:{id:"_2-事务【transaction】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-事务【transaction】"}},[s._v("#")]),s._v(" 2 事务【transaction】")]),s._v(" "),a("ol",[a("li",[s._v("事务是一个不可分割的执行单元")]),s._v(" "),a("li",[s._v("事务作为一个整体要么一起执行，要么一起回滚")])]),s._v(" "),a("p",[s._v("插入测试数据")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create table bank(\n    -> cardid char(4) primary key,\n    -> money int\n    -> );\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> insert into bank values ('1001',1000),('1002',100);\nQuery OK, 2 rows affected (0.00 sec)\nRecords: 2  Duplicates: 0  Warnings: 0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"_2-1-事务操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-事务操作"}},[s._v("#")]),s._v(" 2.1 事务操作")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("开启事务：start transaction或begin [work]\n提交事务：commit\n回滚事务：rollback\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> delimiter //            # 更改定界符\n\nmysql> start transaction;\t\t\t# 开启事务\n    -> update bank set money=money-100 where cardid='1001';\n    -> update bank set money=money+100 where cardid='1002'  //\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> commit //   # 提交事务\n\nmysql> rollback //  # 回滚事务\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("思考：事务什么时候产生？什么时候结束？\n答：开启的时候产生，提交事务或回滚事务都结束\n\n脚下留心：只有innodb和BDB才支持事务，myisam不支持事务。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"_2-2-设置事务的回滚点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-设置事务的回滚点"}},[s._v("#")]),s._v(" 2.2 设置事务的回滚点")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("设置回滚点： savepoint 回滚点名\n回滚到回滚点： rollback to 回滚点\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql>  start transaction;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> insert into bank values ('1003',1000);\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> savepoint aa;    # 设置回滚点 aa\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> insert into bank values ('1004',500);\nQuery OK, 1 row affected (0.00 sec)\n \nmysql> savepoint bb;   # 设置回滚点bb\nQuery OK, 0 rows affected (0.00 sec)\n \nmysql> rollback to aa;    # 回滚到aa点\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> commit;    # 提交事务\n\nmysql> select * from bank ;\n+--------+-------+\n| cardid | money |\n+--------+-------+\n| 1001   |   800 |\n| 1002   |   200 |\n| 1003   |  1000 |\n+--------+-------+\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br")])]),a("h3",{attrs:{id:"_2-3-事务的特性-acid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-事务的特性-acid"}},[s._v("#")]),s._v(" 2.3 事务的特性（ACID）")]),s._v(" "),a("ol",[a("li",[s._v("原子性（Atomicity）：事务是一个整体，不可以再分，要么一起执行，要么一起不执行。")]),s._v(" "),a("li",[s._v("一致性（Consistency）：事务完成时，数据必须处于一致的状态。")]),s._v(" "),a("li",[s._v("隔离性（Isolation）：每个事务都是相互隔离的")]),s._v(" "),a("li",[s._v("永久性（Durability）：事务完成后，对数据的修改是永久性的。")])]),s._v(" "),a("h2",{attrs:{id:"_3-索引【index】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-索引【index】"}},[s._v("#")]),s._v(" 3 索引【index】")]),s._v(" "),a("p",[s._v("索引的优点：查询速度快")]),s._v(" "),a("p",[s._v("索引的缺点：")]),s._v(" "),a("ol",[a("li",[s._v("增、删、改（数据操作语句）效率低了")]),s._v(" "),a("li",[s._v("索引占用空间")])]),s._v(" "),a("h3",{attrs:{id:"_3-1索引的类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1索引的类型"}},[s._v("#")]),s._v(" 3.1\t索引的类型")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("普通索引")])]),s._v(" "),a("li",[a("p",[s._v("唯一索引（唯一键）")])]),s._v(" "),a("li",[a("p",[s._v("主键索引：只要主键就自动创建主键索引，不需要手动创建。")])]),s._v(" "),a("li",[a("p",[s._v("全文索引，搜索引擎使用，MySQL不支持中文的全文索引，我们通过sphinx去解决中文的全文索引。")])])]),s._v(" "),a("h3",{attrs:{id:"_3-2创建普通索引【create-index】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2创建普通索引【create-index】"}},[s._v("#")]),s._v(" 3.2\t创建普通索引【create index】")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create index [索引名] on 表名 （字段名）\nalter table 表名 add index [索引的名称] （列名）\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 创建索引方法一\nmysql> create index ix_stuname on stuinfo(stuname);\nQuery OK, 0 rows affected (0.08 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\n# 创建索引方法二\nmysql> alter table stuinfo add index ix_address (stuaddress);\nQuery OK, 0 rows affected (0.08 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\n# 创建表的时候就添加索引\nmysql> create table emp(\n    -> id int,\n    -> name varchar(10),\n    -> index ix_name (name)   # 创建索引\n    -> );\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"_3-3创建唯一索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3创建唯一索引"}},[s._v("#")]),s._v(" 3.3\t创建唯一索引")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("语法一：create unique index 索引名 on 表名 （字段名）\n语法二：alter table 表名 add unqiue [index] [索引的名称] （列名）\n语法三：创建表的时候添加唯一索引，和创建唯一键是一样的。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("例题")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 方法一：\nmysql> create unique index UQ_stuname on stu(stuname);\nQuery OK, 0 rows affected (0.06 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\n# 方法二：\nmysql> alter table stu add unique UQ_address (stuaddress);\nQuery OK, 0 rows affected (0.02 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\n# 方法三\nmysql> create table stu2(\n    -> id int,\n    -> name varchar(20),\n    -> unique UQ_name(name)\n    -> );\nQuery OK, 0 rows affected (0.01 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h3",{attrs:{id:"_3-4删除索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4删除索引"}},[s._v("#")]),s._v(" 3.4\t删除索引")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("drop index 索引名 on 表名\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> drop index ix_stuname on stuinfo;\nQuery OK, 0 rows affected (0.03 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"_3-5创建索引的指导原则"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-5创建索引的指导原则"}},[s._v("#")]),s._v(" 3.5\t创建索引的指导原则")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("该列用于频繁搜索")])]),s._v(" "),a("li",[a("p",[s._v("改列用于排序")])]),s._v(" "),a("li",[a("p",[s._v("公共字段要创建索引")])]),s._v(" "),a("li",[a("p",[s._v("如果表中的数据很少，不需要创建索引。MySQL搜索索引的时间比逐条搜索数据的时间要长。")])]),s._v(" "),a("li",[a("p",[s._v("如果一个字段上的数据只有几个不同的值，改字段不适合做索引，比如性别。")])])]),s._v(" "),a("h2",{attrs:{id:"_4-函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-函数"}},[s._v("#")]),s._v(" 4  函数")]),s._v(" "),a("h3",{attrs:{id:"_4-1-数字类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-数字类"}},[s._v("#")]),s._v(" 4.1  数字类")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> select rand();\t\t\t# 生成随机数\n+---------------------+\n| rand()              |\n+---------------------+\n| 0.18474003969201822 |\n+---------------------+\n1 row in set (0.00 sec)\n\nmysql> select * from stuinfo order by rand();   # 随机排序\n\nmysql> select * from stuinfo order by rand() limit 2;    # 随机抽两个学生\n+--------+----------+--------+--------+---------+------------+\n| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |\n+--------+----------+--------+--------+---------+------------+\n| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |\n| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |\n+--------+----------+--------+--------+---------+------------+\n2 rows in set (0.00 sec)\n\nmysql> select round(3.5);     #四舍五入\n+------------+\n| round(3.5) |\n+------------+\n|          4 |\n+------------+\n1 row in set (0.00 sec)\n\nmysql> select ceil(3.1);\t# 向上取整\n+-----------+\n| ceil(3.1) |\n+-----------+\n|         4 |\n+-----------+\n1 row in set (0.00 sec)\n\nmysql> select floor(3.9);\t# 向下取整\n+------------+\n| floor(3.9) |\n+------------+\n|          3 |\n+------------+\n1 row in set (0.00 sec)\n\nmysql> select truncate(3.1415926,3);\t# 截取数字\n+-----------------------+\n| truncate(3.1415926,3) |\n+-----------------------+\n|                 3.141 |\n+-----------------------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br")])]),a("h3",{attrs:{id:"_4-2-字符串类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-字符串类"}},[s._v("#")]),s._v(" 4.2 字符串类")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> select ucase('i am a boy!');\t\t# 转成大写\n+----------------------+\n| ucase('i am a boy!') |\n+----------------------+\n| I AM A BOY!          |\n+----------------------+\n1 row in set (0.00 sec)\n\nmysql> select lcase('I Am A Boy!');\t\t#转成小写\n+----------------------+\n| lcase('I Am A Boy!') |\n+----------------------+\n| i am a boy!          |\n+----------------------+\n1 row in set (0.00 sec)\n\nmysql> select left('abcde',3);\t\t# 从左边开始截取，截取3个\n+-----------------+\n| left('abcde',3) |\n+-----------------+\n| abc             |\n+-----------------+\n1 row in set (0.00 sec)\n\nmysql> select right('abcde',3);\t\t# 从右边开始截取，截取3个\n+------------------+\n| right('abcde',3) |\n+------------------+\n| cde              |\n+------------------+\n1 row in set (0.00 sec)\n\nmysql> select substring('abcde',2,3);\t#从第2个位置开始截取，截取3个【位置从1开始】\n+------------------------+\n| substring('abcde',2,3) |\n+------------------------+\n| bcd                    |\n+------------------------+\n1 row in set (0.00 sec)\n\nmysql> select concat('中国','上海');\t# 字符串相连\n+-----------------------+\n| concat('中国','上海')       |\n+-----------------------+\n| 中国上海                    |\n+-----------------------+\n1 row in set (0.00 sec)\n\nmysql> select concat(stuname,'-',stusex) from stuinfo;  # 将表中的姓名和性别连接起来\n+----------------------------+\n| concat(stuname,'-',stusex) |\n+----------------------------+\n| 张秋丽-男                          |\n| 李文才-男                         |\n| 李斯文-女                        |\n| 欧阳俊雄-男                         |\n| 诸葛丽丽-女                         |\n| 争青小子-男                         |\n| 梅超风-女                        |\n+----------------------------+\n7 rows in set (0.00 sec)\n\n# coalesce(字段1，字段2)  如果字段1不为空就显示字段1，否则，显示字段2\nmysql> select stuname,coalesce(writtenexam,'缺考'),coalesce(labexam,'缺考') from stuinfo natural left join stumarks;   # 将考试成绩为空的显示为缺考\n+----------+------------------------------+--------------------------+\n| stuname  | coalesce(writtenexam,'缺考')    | coalesce(labexam,'缺考')    |\n+----------+------------------------------+--------------------------+\n| 张秋丽         | 77                           | 82                       |\n| 李文才        | 50                           | 90                       |\n| 李斯文        | 88                           | 58                       |\n| 欧阳俊雄        | 65                           | 50                       |\n| 诸葛丽丽         | 缺考                            | 缺考                        |\n| 争青小子        | 56                           | 48                       |\n| 梅超风        | 缺考                            | 缺考                        |\n+----------+------------------------------+--------------------------+\n\nmysql> select length('锄禾日当午');\t\t# 字节长度\n+----------------------+\n| length('锄禾日当午')          |\n+----------------------+\n|                   10 |\n+----------------------+\n1 row in set (0.00 sec)\n\nmysql> select char_length('锄禾日当午');\t\t# 字符个数\n+---------------------------+\n| char_length('锄禾日当午')          |\n+---------------------------+\n|                         5 |\n+---------------------------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br")])]),a("h3",{attrs:{id:"_4-3-时间类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-时间类"}},[s._v("#")]),s._v(" 4.3 时间类")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> select unix_timestamp();\t#获取时间戳\n+------------------+\n| unix_timestamp() |\n+------------------+\n|       1537084508 |\n+------------------+\n1 row in set (0.00 sec)\n\nmysql> select from_unixtime(unix_timestamp());\t# 将时间戳转成年-月-日 小时:分钟:秒的格式\n+---------------------------------+\n| from_unixtime(unix_timestamp()) |\n+---------------------------------+\n| 2018-09-16 15:55:56             |\n+---------------------------------+\n1 row in set (0.00 sec)\n\nmysql> select now();\t\t# 获取当前日期时间\n+---------------------+\n| now()               |\n+---------------------+\n| 2018-09-16 15:57:04 |\n+---------------------+\n1 row in set (0.00 sec)\n\nmysql> select year(now()) 年,month(now()) 月, day(now()) 日,hour(now()) 小,minute(now()) 分钟,second(now()) 秒;\n+------+------+------+------+------+------+\n| 年     | 月     | 日     | 小时   | 分钟     | 秒     |\n+------+------+------+------+------+------+\n| 2018 |    9 |   16 |   15 |   59 |   14 |\n+------+------+------+------+------+------+\n1 row in set (0.00 sec)\n\nmysql> select dayname(now()) 星期,monthname(now()),dayofyear(now()) 本年的第几天;\n+--------+------------------+--------------+\n| 星期       | monthname(now()) | 本年的第几天           |\n+--------+------------------+--------------+\n| Sunday | September        |          259 |\n+--------+------------------+--------------+\n1 row in set (0.00 sec)\n\nmysql> select datediff(now(),'2008-8-8');\t# 日期相减\n+----------------------------+\n| datediff(now(),'2008-8-8') |\n+----------------------------+\n|                       3691 |\n+----------------------------+\n1 row in set (0.00 sec)\n\nmysql> select convert(now(),date),convert(now(),time);\t# 将now()转成日期和时间\n+---------------------+---------------------+\n| convert(now(),date) | convert(now(),time) |\n+---------------------+---------------------+\n| 2018-09-16          | 16:07:24            |\n+---------------------+---------------------+\n\nmysql> select cast(now() as date),cast(now() as time);   # 将now()转成日期和时间\n+---------------------+---------------------+\n| cast(now() as date) | cast(now() as time) |\n+---------------------+---------------------+\n| 2018-09-16          | 16:08:03            |\n+---------------------+---------------------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br")])]),a("h3",{attrs:{id:"_4-4-加密函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-加密函数"}},[s._v("#")]),s._v(" 4.4 加密函数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("+----------------------------------+------------------------------------------+\n| md5('root')                      | sha('root')                              |\n+----------------------------------+------------------------------------------+\n| 63a9f0ea7bb98050796b649e85481845 | dc76e9f0c0006e8f919e0c515c66dbba3982f785 |\n+----------------------------------+------------------------------------------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_4-5-判断函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-5-判断函数"}},[s._v("#")]),s._v(" 4.5 判断函数")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("if(表达式,值1,值2)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> select if(10%2=0,'偶数','奇数');\n+--------------------------+\n| if(10%2=0,'偶数','奇数')        |\n+--------------------------+\n| 偶数                        |\n+--------------------------+\n1 row in set (0.00 sec)\n\n# 语文和数学都超过60分才通过\nmysql> select stuname,ch,math,if(ch>=60 && math>=60,'通过','不通过') '是否通过' from stu;\n+----------+------+------+----------+\n| stuname  | ch   | math | 是否通过       |\n+----------+------+------+----------+\n| 张秋丽         |   80 | NULL | 不通过        |\n| 李文才        |   77 |   76 | 通过        |\n| 李斯文        |   55 |   82 | 不通过        |\n| 欧阳俊雄        | NULL |   74 | 不通过        |\n| 诸葛丽丽         |   72 |   56 | 不通过        |\n| 争青小子        |   86 |   92 | 通过        |\n| 梅超风        |   74 |   67 | 通过        |\n| Tom      |   65 |   67 | 通过        |\n| Tabm     |   88 |   77 | 通过        |\n+----------+------+------+----------+\n9 rows in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("h2",{attrs:{id:"_5-预处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-预处理"}},[s._v("#")]),s._v(" 5  预处理")]),s._v(" "),a("p",[s._v("预编译一次，可以多次执行。用来解决一条SQL语句频繁执行的问题。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("预处理语句：prepare 预处理名字 from ‘sql语句’\n执行预处理：execute 预处理名字 [using 变量]\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("例题一：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> prepare stmt from 'select * from stuinfo';\t# 创建预处理\nQuery OK, 0 rows affected (0.00 sec)\nStatement prepared\n\nmysql> execute stmt;\t# 执行预处理\n+--------+----------+--------+--------+---------+------------+\n| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |\n+--------+----------+--------+--------+---------+------------+\n| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           |\n| s25302 | 李文才        | 男       |     31 |       3 | 上海          |\n| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |\n| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |\n| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |\n| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |\n| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |\n+--------+----------+--------+--------+---------+------------+\n7 rows in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("例题二：传递参数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> delimiter // \nmysql> prepare stmt from 'select * from stuinfo where stuno=?' // -- ?是位置占位符\nQuery OK, 0 rows affected (0.00 sec)\nStatement prepared\n\nmysql> set @id='s25301';       -- 变量以@开头，通过set给变量赋值\n    -> execute stmt using @id //  -- 执行预处理，传递参数\nQuery OK, 0 rows affected (0.00 sec)\n\n+--------+---------+--------+--------+---------+------------+\n| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress |\n+--------+---------+--------+--------+---------+------------+\n| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |\n+--------+---------+--------+--------+---------+------------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("脚下留心：\n1、?是位置占位符\n2、变量以@开头\n3、通过set给变量赋值\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("例题三：传递多个参数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> prepare stmt from 'select * from stuinfo where stusex=? and stuaddress=?'  //\nQuery OK, 0 rows affected (0.00 sec)\nStatement prepared\n\nmysql> set @sex='男';\n    -> set @addr='北京';\n    -> execute stmt using @sex,@addr //\nQuery OK, 0 rows affected (0.00 sec)\n\nQuery OK, 0 rows affected (0.00 sec)\n\n+--------+---------+--------+--------+---------+------------+\n| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress |\n+--------+---------+--------+--------+---------+------------+\n| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |\n+--------+---------+--------+--------+---------+------------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("h2",{attrs:{id:"_6-存储过程【procedure】"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-存储过程【procedure】"}},[s._v("#")]),s._v(" 6 存储过程【procedure】")]),s._v(" "),a("h3",{attrs:{id:"_6-1-存储过程的优点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-存储过程的优点"}},[s._v("#")]),s._v(" 6.1 存储过程的优点")]),s._v(" "),a("ol",[a("li",[s._v("存储过程可以减少网络流量")]),s._v(" "),a("li",[s._v("允许模块化设计")]),s._v(" "),a("li",[s._v("支持事务")])]),s._v(" "),a("h3",{attrs:{id:"_6-2创建存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2创建存储过程"}},[s._v("#")]),s._v(" 6.2\t创建存储过程")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create procedure 存储过程名(参数)\nbegin\n\t//sql语句\nend;\n\n脚下留心：由于过程中有很多SQL语句，每个语句的结束都要用（；）结束。默认情况下，分号既表示语句结束，又表示向服务器发送SQL语句。我们希望分号仅表示语句的结束，不要将SQL语句发送到服务器执行，通过delimiter来更改结束符。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("例题")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> delimiter //\nmysql> create procedure proc()     -- 创建存储过程\n    -> begin\n    -> select * from stuinfo;\n    -> end //\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"_6-3调用存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-3调用存储过程"}},[s._v("#")]),s._v(" 6.3\t调用存储过程")]),s._v(" "),a("p",[s._v("语法：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("call 存储过程名()\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> call proc() //     -- 调用存储过程\n+--------+----------+--------+--------+---------+------------+\n| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |\n+--------+----------+--------+--------+---------+------------+\n| s25301 | 张秋丽         | 男       |     18 |       1 | 北京           |\n| s25302 | 李文才        | 男       |     31 |       3 | 上海          |\n| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |\n| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |\n| s25305 | 诸葛丽丽         | 女      |     23 |       7 | 河南           |\n| s25318 | 争青小子        | 男       |     26 |       6 | 天津           |\n| s25319 | 梅超风        | 女      |     23 |       5 | 河北          |\n+--------+----------+--------+--------+---------+------------+\n7 rows in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"_6-4删除存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-4删除存储过程"}},[s._v("#")]),s._v(" 6.4\t删除存储过程")]),s._v(" "),a("p",[s._v("语法")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("drop procedure [if exists] 存储过程名\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> drop procedure proc //    -- 删除存储过程\nQuery OK, 0 rows affected (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"_6-5-查看存储过程的信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-5-查看存储过程的信息"}},[s._v("#")]),s._v(" 6.5  查看存储过程的信息")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("show create procedure 存储过程名\\G\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("例题")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> show create procedure proc \\G\n*************************** 1. row ***************************\n           Procedure: proc\n            sql_mode: STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\n    Create Procedure: CREATE DEFINER=`root`@`localhost` PROCEDURE `proc`()\nbegin\nselect * from stuinfo;\nend\ncharacter_set_client: gbk\ncollation_connection: gbk_chinese_ci\n  Database Collation: utf8_general_ci\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"_6-6-显示所有的存储过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-6-显示所有的存储过程"}},[s._v("#")]),s._v(" 6.6 显示所有的存储过程")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> show procedure status \\G\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"_6-7存储过程的参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-7存储过程的参数"}},[s._v("#")]),s._v(" 6.7\t存储过程的参数")]),s._v(" "),a("p",[s._v("存储过程的参数分为：输入参数（in）【默认】，输出参数（out），输入输出参数（inout）")]),s._v(" "),a("p",[s._v("存储过程不能使用return返回值，要返回值只能通过“输出参数”来向外传递值。")]),s._v(" "),a("p",[s._v("例题一：传递学号，获取对应的信息")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create procedure proc(in param varchar(10))   -- 输入参数\n    -> select * from stuinfo where stuno=param //\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> call proc('s25301') //\n+--------+---------+--------+--------+---------+------------+\n| stuNo  | stuName | stuSex | stuAge | stuSeat | stuAddress |\n+--------+---------+--------+--------+---------+------------+\n| s25301 | 张秋丽        | 男       |     18 |       1 | 北京           |\n+--------+---------+--------+--------+---------+------------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("例题二：查找同桌")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create procedure proc(name varchar(10))\n    -> begin\n    -> declare seat tinyint;   -- 声明局部变量\n    -> select stuseat into seat from stuinfo where stuname=name;  -- 将座位号保存到变量中\n    -> select * from stuinfo where stuseat=seat+1 or stuseat=seat-1;  -- 查找同桌\n    -> end //\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> call proc('李文才') //\n+--------+----------+--------+--------+---------+------------+\n| stuNo  | stuName  | stuSex | stuAge | stuSeat | stuAddress |\n+--------+----------+--------+--------+---------+------------+\n| s25303 | 李斯文        | 女      |     22 |       2 | 北京           |\n| s25304 | 欧阳俊雄        | 男       |     28 |       4 | 天津           |\n+--------+----------+--------+--------+---------+------------+\n2 rows in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("强调")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("1、通过declare关键字声明局部变量；全局变量@开头就可以了\n2、给变量赋值有两种方法\n\t方法一：set 变量名=值\n\t方法二：select 字段 into 变量 from 表 where 条件\n3、声明的变量不能与列名同名\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("例题三：输出参数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create procedure proc(num int, out result int)  //out 表示输出参数\n    -> begin\n    -> set result=num*num;\n    -> end //\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> call proc(10,@result) //\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> select @result //\n+---------+\n| @result |\n+---------+\n|     100 |\n+---------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("例题四：输入输出参数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create procedure proc(inout num int)  #  inout 表示是输入输出参数\n    -> begin\n    -> set num=num*num;\n    -> end //\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> set @num=10;\n    -> call proc(@num);\n    -> select @num //\nQuery OK, 0 rows affected (0.00 sec)\n\nQuery OK, 0 rows affected (0.00 sec)\n\n+------+\n| @num |\n+------+\n|  100 |\n+------+\n1 row in set (0.00 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h2",{attrs:{id:"_7-go连接mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-go连接mysql"}},[s._v("#")]),s._v(" 7 GO连接MySQL")]),s._v(" "),a("ol",[a("li",[s._v("因为Go语言没有提供任何官方数据库驱动，所以需要安装第三方函数库。")]),s._v(" "),a("li",[s._v("由于在github上安装，所以需要安装git软件，安装过程一直点击下一步即可。安装完成后需要配置环境变量")])]),s._v(" "),a("h3",{attrs:{id:"_7-1-安装git"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-安装git"}},[s._v("#")]),s._v(" 7.1  安装git")]),s._v(" "),a("p",[s._v("git软件")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/1537011074242.png",alt:"1537011074242"}})]),s._v(" "),a("p",[s._v("安装完毕后，配置git的环境变量，这样可以使用"),a("code",[s._v("get")]),s._v("的指令")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/1537094210154.png",alt:"1537094210154"}})]),s._v(" "),a("h3",{attrs:{id:"_7-2-安装数据库驱动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-安装数据库驱动"}},[s._v("#")]),s._v(" 7.2  安装数据库驱动")]),s._v(" "),a("p",[s._v("设置GOPATH的环境变量，这样驱动才会下载到项目根目录中。")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/1537094342573.png",alt:"1537094342573"}}),s._v("****")]),s._v(" "),a("p",[s._v("在cmd命令窗口中输入如下命令安装驱动")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" get github"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("sql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("driver"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql\n\n这一命令会从代码中获取驱动的具体代码，并将这些代码放置到包库中，当需要用到驱动的时候，编译器会把驱动代码与用户编写的代码一同编译。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("安装完毕后，会在GOPATH下看到下载的驱动")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/1537011722807.png",alt:"1537011722807"}})]),s._v(" "),a("h3",{attrs:{id:"_7-3-连接数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-连接数据库"}},[s._v("#")]),s._v(" 7.3  连接数据库")]),s._v(" "),a("p",[s._v("1、在src目录下创建demo.go文件，导入数据库驱动")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database/sql"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("_")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/go-sql-driver/mysql"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n注意：程序在操作数据库的时候只需要用到database"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("sql，而不需要直接使用数据库驱动，所以程序在导入数据库驱动的时候将这个包的名字设置成下划线。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("2、通过sql.open()连接数据库")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('sql.open(驱动名,数据源dsn)(*DB,err)\n\n数据源语法："用户名:密码@[连接方式](主机名:端口号)/数据库名"\n\n注意：open()在执行时不会真正的与数据库进行连接，只是设置连接数据库需要的参数\nping()方法才是连接数据库\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("3、执行SQL语句")]),s._v(" "),a("p",[s._v("​\t创建测试表")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("mysql> create table stu(\n    -> id int primary key,\n    -> name varchar(10)\n    -> );\nQuery OK, 0 rows affected (0.02 sec)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("操作数据")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('package main\n\nimport (\n\t"database/sql"\n\t_ "github.com/go-sql-driver/mysql"\n\t"fmt"\n)\n\nfunc main(){\n\t//"用户名:密码@[连接方式](主机名:端口号)/数据库名"\n\tdb,_:=sql.Open("mysql","root:root@(127.0.0.1:3306)/itcast") // 设置连接数据库的参数\n\tdefer db.Close()\t//关闭数据库\n\terr:=db.Ping()\t\t//连接数据库\n\tif err!=nil{\n\t\tfmt.Println("数据库连接失败")\n\t\treturn\n\t}\n\n\t//操作一：执行数据操作语句\n\t/*\n\tsql:="insert into stu values (2,\'berry\')"\n\tresult,_:=db.Exec(sql)\t\t//执行SQL语句\n\tn,_:=result.RowsAffected();\t//获取受影响的记录数\n\tfmt.Println("受影响的记录数是",n)\n\t*/\n\n\t//操作二：执行预处理\n\t/*\n\tstu:=[2][2] string{{"3","ketty"},{"4","rose"}}\n\tstmt,_:=db.Prepare("insert into stu values (?,?)")\t\t//获取预处理语句对象\n\tfor _,s:=range stu{\n\t\tstmt.Exec(s[0],s[1])\t\t\t//调用预处理语句\n\t}\n\t*/\n\n\t//操作三：单行查询\n\t/*\n\tvar id,name string\n\trows:=db.QueryRow("select * from stu where id=4")   //获取一行数据\n\trows.Scan(&id,&name)\t\t//将rows中的数据存到id,name中\n\tfmt.Println(id,"--",name)\n\t*/\n\n\t//操作四：多行查询\n\trows,_:=db.Query("select * from stu")\t\t//获取所有数据\n\tvar id,name string\n\tfor rows.Next(){\t\t//循环显示所有的数据\n\t\trows.Scan(&id,&name)\n\t\tfmt.Println(id,"--",name)\n\t}\n}\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br")])]),a("h2",{attrs:{id:"_8-例题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-例题"}},[s._v("#")]),s._v(" 8  例题")]),s._v(" "),a("p",[s._v("1、\t显示地区及每个地区参加考试的人数，并按人数降序排列。")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select stuaddress,count(writtenexam) c from stuinfo left join stumarks using(stuno) group by stuaddress order by c desc;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("2、\t显示有学生参加考试的地区")]),s._v(" "),a("p",[s._v("方法一：过滤")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select stuaddress,count(writtenexam) c from stuinfo left join stumarks using(stuno) group by stuaddress having c>0;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("方法二：链接查询")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select distinct stuaddress c from stuinfo right join stumarks using(stuno) ;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("3、\t显示男生和女生的人数")]),s._v(" "),a("p",[s._v("方法一：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select stusex,count() from stuinfo where stusex='男' union select stusex,count() from stuinfo where stusex='女';\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("方法二：")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select sum(stusex='男') 男,sum(stusex='女') 女 from stuinfo;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("4、\t显示每个地区的男生和女生和总人数")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("select stuaddress,count(stusex) 总人数, sum(stusex='男') 男,sum(stusex='女') 女 from stuinfo group by stuaddress\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);